
[request_definition]
r = person_id, action, item, item_id

# action = r,w,all or d (d permission is not in the database)

[policy_definition]
p = person_id, perm, item, entity_id

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# do NOT edit this file. This file is generated by the chimitheque_utils/src/casbin.rs
# doc. in chimitheque_utils/src/casbin.rs
m = ( (r.person_id == p.person_id) && ( (p.perm == "all" && p.item == "all" && p.entity_id == "-1") || \
            (\
            (r.action == "r" && (p.perm == "r" || p.perm == "w" || p.perm == "all")) || \
            ((r.action == "c" || r.action == "d" || r.action == "u") && (p.perm == "w" || p.perm == "all")) || \
            (r.action == "all" && p.perm == "all") \
            ) ) && ( \
        ( (r.item == "products" && r.action == "c") &&  (p.item == "products" || p.item =="all") ) || \
        ( (r.item == "products" && r.action == "r" && r.item_id == "") &&  (p.item == "products" || p.item =="all") ) || \
        ( (r.item == "products" && r.action == "r" && r.item_id != "") &&  (p.item == "products" || p.item =="all") ) || \
        ( (r.item == "products" && r.action == "u") &&  (p.item == "products" || p.item =="all") ) || \
        ( (r.item == "products" && r.action == "d") &&  (p.item == "products" || p.item =="all") && !matchProductHasStorages(r.item_id) ) || \
        \
        ( (r.item == "rproducts" && r.action == "c") &&  (p.item == "rproducts" || p.item =="all") ) || \
        ( (r.item == "rproducts" && r.action == "r" && r.item_id == "") &&  (p.item == "rproducts" || p.item =="all") ) || \
        ( (r.item == "rproducts" && r.action == "r" && r.item_id != "") &&  (p.item == "rproducts" || p.item =="all") ) || \
        ( (r.item == "rproducts" && r.action == "u") &&  (p.item == "rproducts" || p.item =="all") ) || \
        ( (r.item == "rproducts" && r.action == "d") &&  (p.item == "rproducts" || p.item =="all") && !matchProductHasStorages(r.item_id) ) || \
        \
        ( (r.item == "storages" && r.action == "c") &&  (p.item == "storages" || p.item =="all") ) || \
        ( (r.item == "storages" && r.action == "r" && r.item_id == "") &&  (p.item == "storages" || p.item =="all") ) || \
        ( (r.item == "storages" && r.action == "r" && r.item_id != "") &&  (p.item == "storages" || p.item =="all") && (p.entity_id == "-1" || matchStorageIsInEntity(r.item_id,p.entity_id)) ) || \
        ( (r.item == "storages" && r.action == "u") &&  (p.item == "storages" || p.item =="all") && (p.entity_id == "-1" || matchStorageIsInEntity(r.item_id,p.entity_id)) ) || \
        ( (r.item == "storages" && r.action == "d") &&  (p.item == "storages" || p.item =="all") && (p.entity_id == "-1" ||matchStorageIsInEntity(r.item_id,p.entity_id)) ) || \
        \
        ( (r.item == "store_locations" && r.action == "c") &&  (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "store_locations" && r.action == "r" && r.item_id == "") &&  (p.item == "storages" || p.item =="all") ) || \
        ( (r.item == "store_locations" && r.action == "r" && r.item_id != "") &&  (p.item == "storages" || p.item =="all") && (p.entity_id == "-1" || matchStoreLocationIsInEntity(r.item_id,p.entity_id)) ) || \
        ( (r.item == "store_locations" && r.action == "u") &&  (p.item == "entities" || p.item =="all") && (p.entity_id == "-1" || matchStoreLocationIsInEntity(r.item_id,p.entity_id)) ) || \
        ( (r.item == "store_locations" && r.action == "d") &&  (p.item == "entities" || p.item =="all") && (p.entity_id == "-1" || matchStoreLocationIsInEntity(r.item_id,p.entity_id)) && !matchStoreLocationHasChildren(r.item_id) && !matchStoreLocationHasStorages(r.item_id) ) || \
        \
        ( (r.item == "people" && r.action == "c") &&  (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "people" && r.action == "r" && r.item_id == "") &&  (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "people" && r.action == "r" && r.item_id != "") &&  (p.item == "entities" || p.item =="all") && (p.entity_id == "-1" || matchPersonIsInEntity(r.item_id,p.entity_id)) ) || \
        ( (r.item == "people" && r.action == "u") &&  (p.item == "entities" || p.item == "all") && (p.entity_id == "-1" || matchPersonIsInEntity(r.item_id,p.entity_id)) && !matchPersonIsAdmin(r.item_id) ) || \
        ( (r.item == "people" && r.action == "d") &&  (p.item == "entities" || p.item =="all") && (p.entity_id == "-1" || matchPersonIsInEntity(r.item_id,p.entity_id)) && !matchPersonIsManager(r.item_id) && !matchPersonIsAdmin(r.item_id) ) || \
        \
        ( (r.item == "entities" && r.action == "c")                    && (p.perm == "all" && p.entity_id == "-1" && p.item == "all") ) || \
        ( (r.item == "entities" && r.action == "r" && r.item_id == "") && (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "entities" && r.action == "r" && r.item_id != "") && (r.item_id == p.entity_id || p.entity_id == "-1") && (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "entities" && r.action == "u")                    && (r.item_id == p.entity_id || p.entity_id == "-1") && (p.item == "entities" || p.item =="all") ) || \
        ( (r.item == "entities" && r.action == "d")                    && (p.perm == "all" && p.entity_id == "-1" && p.item == "all") && !matchEntityHasMembers(r.item_id) && !matchEntityHasStoreLocations(r.item_id) ) || \
        \
        ( (r.item == "bookmarks" || r.item == "download" || r.item == "validate") && (p.item == "products" || p.item =="all") ) || \
        \
        ( (r.item == "userinfo" || r.item == "ping") ) || \
        \
        ( (r.item == "stocks" && r.action == "r") && (p.item == "storages" || p.item =="all") ) ) )
